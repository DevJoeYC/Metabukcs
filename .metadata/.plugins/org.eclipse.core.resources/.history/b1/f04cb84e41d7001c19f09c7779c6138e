package meta.dto;

import java.util.ArrayList;
import meta.dbms.*;
import meta.vo.*;

public class productsDTO extends DBManager
{
	private	String					sql			= "";
	private	String					where		= "";
	private	String					tableName	= "";
	private	ArrayList<productsVO>	List		= null;
	private	ArrayList<productsVO>	MenuList	= null;
	private	ArrayList<productsVO>	ProList		= null;
	
	
	public int GetTotal()
	{
		int total = 0;

		//데이터베이스에 연결한다.
		if(this.DBOpen() == false) return 0;

		//전체 갯수를 얻는다.
		String sql;
		sql  = "select count(*) as count ";
		sql += "from board ";
		if(where.equals("") != true)
		{
			sql += "where " + where;
		}

		this.OpenQuery(sql);
		this.GetNext();
		total = this.GetInt("count");
		this.CloseQuery();

		//데이터베이스 연결을 종료한다.
		this.DBClose();

		return total;
	}
	
	public productsVO GetMenuItem(int index)
	{
		if(this.MenuList == null) this.GetMenuList();
		return MenuList.get(index);
	}
	
	public productsVO GetProItem(int index)
	{
		if(this.ProList == null) this.GetProList();
		return ProList.get(index);
	}

	public void GetMenuList()
	{
		tableName = "menu_list";
		this.GetList(tableName);
	}

	public void GetProList()
	{
		tableName = "pro_list";
		this.GetList(tableName);
	}

	public void GetList(String type)
	{
		ArrayList<productsVO> list = null;
		tableName = type;
		System.out.println("productsDTO getList [DB open]");
		if(this.DBOpen() == false) { System.out.println("productsDTO getList [DB open] fail"); return; }

		sql  = "select * from " + tableName;
		System.out.println("productsDTO getList [make SQL] :\n" + sql);
		System.out.println("productsDTO getList [Open Query]");
		this.OpenQuery(sql);
		while(this.GetNext() == true)
		{
			if(list == null) list = new ArrayList<productsVO>();

			productsVO item = new productsVO( this, type );
			list.add(item);
		}
		//데이터베이스 연결을 종료한다.
		System.out.println("productsDTO getMenuList [close Query]");
		this.CloseQuery();
		System.out.println("productsDTO getMenuList [DB close]");
		this.DBClose();
		
		if(type.equals("menu_list")) { this.MenuList = list; }
		else { this.ProList = list; }
	}
	
	public ArrayList<productsVO> GgetNutri()
	{
		return null;
	}
	
	public ArrayList<productsVO> GgetRecipe()
	{
		return null;
	}
}
